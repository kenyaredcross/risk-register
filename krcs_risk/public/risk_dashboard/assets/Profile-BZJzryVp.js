import{a as v}from"./index-DMXc1wYA.js";import{E as S,o as l,e as o,f as e,t as a,F as g,C as x,n as b,j as h,r as c,c as y,m}from"./vue-vendor-Bo70p1Jw.js";const C={class:"animate-fade-in"},R={key:0,class:"flex items-center justify-center py-20"},A={key:1,class:"card bg-red-50 border-red-200"},D={class:"text-red-600"},z={key:2,class:"space-y-6"},L={class:"card"},j={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},B={class:"text-lg text-charcoal"},M={class:"text-lg text-charcoal"},P={class:"text-lg text-charcoal"},U={class:"text-lg text-charcoal"},F={class:"text-lg text-charcoal"},V={class:"text-lg text-charcoal"},E={class:"text-lg text-charcoal"},T={class:"text-lg text-charcoal"},K={class:"card"},I={key:0,class:"flex flex-wrap gap-2"},H={key:1,class:"text-medium-gray"},J={class:"card"},O={key:0,class:"flex flex-wrap gap-2"},W={key:1,class:"text-medium-gray"},Z={class:"card"},$={key:0,class:"space-y-3"},q={class:"flex items-start justify-between"},G={class:"flex-1"},Q={class:"flex items-center space-x-2 mb-2"},X={class:"font-semibold text-charcoal"},Y={key:0,class:"px-2 py-0.5 bg-red-primary text-white rounded-full text-xs font-semibold"},ee={class:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-medium-gray"},te={class:"md:col-span-2"},se={key:1,class:"text-medium-gray"},ae={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},le={class:"card"},oe={class:"flex items-center space-x-3"},re={class:"text-lg font-semibold text-charcoal"},ne={class:"card"},ie={class:"flex items-center space-x-3"},de={class:"card"},ce={class:"flex items-center space-x-3"},me={class:"text-lg font-semibold text-charcoal"},ge={__name:"Profile",setup(ue){const u=c(!0),d=c(""),s=c(null),_=c([]),f=y(()=>{var n;return(n=s.value)!=null&&n.roles?s.value.roles.filter(t=>t.role.startsWith("KRCS ")).map(t=>t.role):[]}),k=y(()=>{var t;if(!((t=s.value)!=null&&t.krcs_department))return null;const n=_.value.find(i=>i.name===s.value.krcs_department);return n?n.department_name:s.value.krcs_department}),w=n=>n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A",p=n=>n?new Date(n).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",N=async()=>{u.value=!0,d.value="";try{const t=(await v.get("/api/method/frappe.auth.get_logged_user")).data.message,i=await v.get(`/api/resource/User/${t}`,{params:{fields:JSON.stringify(["name","email","first_name","last_name","full_name","username","krcs_department","user_type","language","time_zone","enabled","creation","last_login","last_active","last_ip","roles","active_sessions"])}});s.value=i.data.data;const r=await v.get("/api/method/krcs_risk.krcs_risk_management.doctype.program_risk_register.api.get_departments");_.value=r.data.message||[]}catch(n){console.error("Failed to load profile:",n),d.value="Failed to load profile information. Please try again."}finally{u.value=!1}};return S(()=>{N()}),(n,t)=>{var i;return l(),o("div",C,[t[23]||(t[23]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-charcoal mb-2"},"My Profile"),e("p",{class:"text-medium-gray"},"View and manage your account information")],-1)),u.value?(l(),o("div",R,[...t[0]||(t[0]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-primary"},null,-1)])])):d.value?(l(),o("div",A,[e("p",D,a(d.value),1)])):s.value?(l(),o("div",z,[e("div",L,[t[9]||(t[9]=e("h2",{class:"card-header"},"Personal Information",-1)),e("div",j,[e("div",null,[t[1]||(t[1]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Full Name",-1)),e("p",B,a(s.value.full_name),1)]),e("div",null,[t[2]||(t[2]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Email",-1)),e("p",M,a(s.value.email),1)]),e("div",null,[t[3]||(t[3]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Username",-1)),e("p",P,a(s.value.username||"Not set"),1)]),e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Department",-1)),e("p",U,a(k.value||"Not assigned"),1)]),e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"User Type",-1)),e("p",F,a(s.value.user_type),1)]),e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Language",-1)),e("p",V,a(s.value.language||"English"),1)]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Time Zone",-1)),e("p",E,a(s.value.time_zone||"Not set"),1)]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Last Login",-1)),e("p",T,a(p(s.value.last_login)),1)])])]),e("div",K,[t[10]||(t[10]=e("h2",{class:"card-header"},"KRCS Roles",-1)),f.value.length>0?(l(),o("div",I,[(l(!0),o(g,null,x(f.value,r=>(l(),o("span",{key:r,class:"px-3 py-1.5 bg-red-primary text-white rounded-full text-sm font-medium"},a(r),1))),128))])):(l(),o("p",H,"No KRCS roles assigned"))]),e("div",J,[t[11]||(t[11]=e("h2",{class:"card-header"},"System Roles",-1)),s.value.roles&&s.value.roles.length>0?(l(),o("div",O,[(l(!0),o(g,null,x(s.value.roles,r=>(l(),o("span",{key:r.name,class:"px-3 py-1.5 bg-light-gray text-charcoal rounded-full text-sm"},a(r.role),1))),128))])):(l(),o("p",W,"No roles assigned"))]),e("div",Z,[t[16]||(t[16]=e("h2",{class:"card-header"},"Active Sessions",-1)),s.value.active_sessions&&s.value.active_sessions.length>0?(l(),o("div",$,[(l(!0),o(g,null,x(s.value.active_sessions,r=>(l(),o("div",{key:r.name,class:b(["p-4 bg-light-gray rounded-lg",{"border-2 border-red-primary":r.is_current}])},[e("div",q,[e("div",G,[e("div",Q,[e("span",X,a(r.id),1),r.is_current?(l(),o("span",Y," Current Session ")):h("",!0)]),e("div",ee,[e("div",null,[t[12]||(t[12]=e("span",{class:"font-medium"},"IP Address:",-1)),m(" "+a(r.ip_address),1)]),e("div",null,[t[13]||(t[13]=e("span",{class:"font-medium"},"Created:",-1)),m(" "+a(p(r.session_created)),1)]),e("div",te,[t[14]||(t[14]=e("span",{class:"font-medium"},"User Agent:",-1)),m(" "+a(r.user_agent),1)]),e("div",null,[t[15]||(t[15]=e("span",{class:"font-medium"},"Last Active:",-1)),m(" "+a(p(r.last_updated)),1)])])])])],2))),128))])):(l(),o("p",se,"No active sessions"))]),e("div",ae,[e("div",le,[e("div",oe,[t[18]||(t[18]=e("div",{class:"p-3 bg-red-light rounded-lg"},[e("svg",{class:"w-6 h-6 text-red-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",null,[t[17]||(t[17]=e("p",{class:"text-sm text-medium-gray"},"Member Since",-1)),e("p",re,a(w(s.value.creation)),1)])])]),e("div",ne,[e("div",ie,[t[20]||(t[20]=e("div",{class:"p-3 bg-blue-100 rounded-lg"},[e("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",null,[t[19]||(t[19]=e("p",{class:"text-sm text-medium-gray"},"Account Status",-1)),e("p",{class:b(["text-lg font-semibold",s.value.enabled?"text-green-600":"text-red-600"])},a(s.value.enabled?"Active":"Disabled"),3)])])]),e("div",de,[e("div",ce,[t[22]||(t[22]=e("div",{class:"p-3 bg-purple-100 rounded-lg"},[e("svg",{class:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})])],-1)),e("div",null,[t[21]||(t[21]=e("p",{class:"text-sm text-medium-gray"},"Active Sessions",-1)),e("p",me,a(((i=s.value.active_sessions)==null?void 0:i.length)||0),1)])])])])])):h("",!0)])}}};export{ge as default};
