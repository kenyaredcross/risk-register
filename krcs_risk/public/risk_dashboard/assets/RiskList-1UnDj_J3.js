import{E as T,o,e as l,f as e,x as m,y as F,G as f,F as k,C as _,g as w,t as i,j as v,u as V,m as y,n as C,r,c as M,A as $,i as I}from"./vue-vendor-Bo70p1Jw.js";import{u as P}from"./riskStore-B9zyg5fM.js";import{R as E}from"./RiskCard-u9OTqdrZ.js";import{_ as q,a as G}from"./index-DMXc1wYA.js";import"./useApi-VH5eLdFx.js";const Q={class:"animate-fade-in"},J={class:"card mb-6"},K={class:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4 mb-4"},W={class:"md:col-span-2"},X=["value"],Y=["disabled"],Z=["value"],tt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},et={key:0,class:"mt-4 pt-4 border-t border-light-border flex items-center justify-between"},st={class:"flex items-center flex-wrap gap-2"},at={key:0,class:"badge badge-medium"},ot={key:1,class:"badge badge-medium"},lt={key:2,class:"badge badge-medium"},it={key:3,class:"badge badge-medium"},nt={key:4,class:"badge badge-medium"},rt={key:0,class:"flex items-center justify-center py-20"},dt={key:1},ut={class:"mb-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4"},ct={class:"text-medium-gray"},pt={class:"font-semibold text-charcoal"},mt={class:"font-semibold text-charcoal"},vt={class:"flex flex-wrap items-center gap-3"},xt={class:"inline-flex items-center bg-light-gray rounded-lg p-1 border border-light-border"},gt={class:"flex items-center space-x-2"},ft={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},ht={key:1,class:"card overflow-hidden"},bt={class:"overflow-x-auto"},yt={class:"w-full"},kt={class:"divide-y divide-light-border"},_t={class:"px-4 py-3 text-sm font-medium text-charcoal"},wt={class:"px-4 py-3 text-sm text-medium-gray max-w-xs"},Ct={class:"line-clamp-2"},St={class:"px-4 py-3 text-sm text-medium-gray"},Dt={class:"px-4 py-3 text-sm text-medium-gray"},Rt={class:"px-4 py-3"},Mt={class:"px-4 py-3 text-sm font-medium text-charcoal"},Lt={class:"px-4 py-3 text-sm text-medium-gray"},Ut={class:"px-4 py-3"},Vt={class:"px-4 py-3 text-sm"},Nt={key:0,class:"text-red-600"},Ot={key:1,class:"text-yellow-600"},At={key:2,class:"text-green-600"},zt={key:3,class:"text-medium-gray"},Bt={class:"px-4 py-3 text-right"},Ht=["onClick"],jt={key:2,class:"card text-center py-12"},Tt={__name:"RiskList",setup(Ft){const h=P(),N=$(),x=r(""),d=r(""),u=r(""),c=r(""),n=r(""),p=r(""),S=r("rating-desc"),g=r("card"),D=r([]),R=r([]),O=M(()=>x.value||d.value||u.value||c.value||n.value||p.value),A=M(()=>n.value?R.value.filter(a=>a.department===n.value):[]),b=M(()=>{let a=[...h.risks];if(x.value){const t=x.value.toLowerCase();a=a.filter(s=>(s.name||"").toLowerCase().includes(t)||(s.risk_description||"").toLowerCase().includes(t)||(s.risk_owner||"").toLowerCase().includes(t)||(s.department||"").toLowerCase().includes(t))}return n.value&&(a=a.filter(t=>t.department===n.value)),p.value&&(a=a.filter(t=>t.unit===p.value)),d.value&&(a=a.filter(t=>t.risk_level===d.value)),u.value&&(a=a.filter(t=>t.status===u.value)),c.value&&(a=a.filter(t=>(t.review_status||"Not Scheduled")===c.value)),a.sort((t,s)=>{switch(S.value){case"rating-desc":return(s.overall_rating||0)-(t.overall_rating||0);case"rating-asc":return(t.overall_rating||0)-(s.overall_rating||0);case"date-desc":return new Date(s.creation||0)-new Date(t.creation||0);case"date-asc":return new Date(t.creation||0)-new Date(s.creation||0);case"name":return(t.name||"").localeCompare(s.name||"");default:return 0}}),a}),L=()=>{x.value="",d.value="",u.value="",c.value="",n.value="",p.value=""},z=a=>{const t=D.value.find(s=>s.name===a);return t?t.department_name:a},B=a=>{const t=R.value.find(s=>s.name===a);return t?t.unit_name:a},H=async()=>{try{const t=(await G.get("/api/method/krcs_risk.krcs_risk_management.doctype.program_risk_register.api.get_departments")).data.message||[];D.value=t,R.value=t.flatMap(s=>s.units||[])}catch(a){console.error("Failed to load departments and units",a)}},U=a=>{N.push(`/risk/${a.name}`)};return T(()=>{h.risks.length===0&&h.loadRisks(),H()}),(a,t)=>(o(),l("div",Q,[t[32]||(t[32]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-charcoal mb-2"},"Risk Register"),e("p",{class:"text-medium-gray"},"Complete list of identified risks across the organization")],-1)),e("div",J,[e("div",K,[e("div",W,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Search",-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>x.value=s),type:"text",placeholder:"Search risks...",class:"input"},null,512),[[F,x.value]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Department",-1)),m(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>n.value=s),class:"input"},[t[10]||(t[10]=e("option",{value:""},"All Departments",-1)),(o(!0),l(k,null,_(D.value,s=>(o(),l("option",{key:s.name,value:s.name},i(s.department_name),9,X))),128))],512),[[f,n.value]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Unit",-1)),m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>p.value=s),class:"input",disabled:!n.value},[t[12]||(t[12]=e("option",{value:""},"All Units",-1)),(o(!0),l(k,null,_(A.value,s=>(o(),l("option",{key:s.name,value:s.name},i(s.unit_name),9,Z))),128))],8,Y),[[f,p.value]])])]),e("div",tt,[e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Risk Level",-1)),m(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>d.value=s),class:"input"},[...t[14]||(t[14]=[w('<option value="" data-v-21116703>All Levels</option><option value="Critical" data-v-21116703>Critical</option><option value="High" data-v-21116703>High</option><option value="Medium" data-v-21116703>Medium</option><option value="Low" data-v-21116703>Low</option>',5)])],512),[[f,d.value]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Status",-1)),m(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>u.value=s),class:"input"},[...t[16]||(t[16]=[w('<option value="" data-v-21116703>All Status</option><option value="Open" data-v-21116703>Open</option><option value="In Progress" data-v-21116703>In Progress</option><option value="Closed" data-v-21116703>Closed</option><option value="Mitigated" data-v-21116703>Mitigated</option>',5)])],512),[[f,u.value]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Review Status",-1)),m(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>c.value=s),class:"input"},[...t[18]||(t[18]=[w('<option value="" data-v-21116703>All Reviews</option><option value="Overdue" data-v-21116703>ðŸ”´ Overdue</option><option value="Due Soon" data-v-21116703>ðŸŸ¡ Due Soon</option><option value="On Track" data-v-21116703>ðŸŸ¢ On Track</option><option value="Not Scheduled" data-v-21116703>âšª Not Scheduled</option>',5)])],512),[[f,c.value]])])]),O.value?(o(),l("div",et,[e("div",st,[t[20]||(t[20]=e("span",{class:"text-sm text-medium-gray"},"Active filters:",-1)),n.value?(o(),l("span",at,"Dept: "+i(z(n.value)),1)):v("",!0),p.value?(o(),l("span",ot,"Unit: "+i(B(p.value)),1)):v("",!0),d.value?(o(),l("span",lt,i(d.value),1)):v("",!0),u.value?(o(),l("span",it,i(u.value),1)):v("",!0),c.value?(o(),l("span",nt,i(c.value),1)):v("",!0)]),e("button",{onClick:L,class:"text-sm text-red-primary hover:text-red-hover font-medium"}," Clear All ")])):v("",!0)]),V(h).loading?(o(),l("div",rt,[...t[21]||(t[21]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-primary"},null,-1)])])):(o(),l("div",dt,[e("div",ut,[e("p",ct,[t[22]||(t[22]=y(" Showing ",-1)),e("span",pt,i(b.value.length),1),t[23]||(t[23]=y(" of ",-1)),e("span",mt,i(V(h).risks.length),1),t[24]||(t[24]=y(" risks ",-1))]),e("div",vt,[e("div",xt,[e("button",{type:"button",onClick:t[6]||(t[6]=s=>g.value="card"),class:C([g.value==="card"?"bg-white shadow text-charcoal":"text-medium-gray hover:text-charcoal hover:bg-white/50","inline-flex items-center px-3 py-1.5 rounded-md transition-all text-sm font-medium"])},[...t[25]||(t[25]=[e("svg",{class:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),y(" Cards ",-1)])],2),e("button",{type:"button",onClick:t[7]||(t[7]=s=>g.value="table"),class:C([g.value==="table"?"bg-white shadow text-charcoal":"text-medium-gray hover:text-charcoal hover:bg-white/50","inline-flex items-center px-3 py-1.5 rounded-md transition-all text-sm font-medium"])},[...t[26]||(t[26]=[e("svg",{class:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1),y(" Table ",-1)])],2)]),e("div",gt,[t[28]||(t[28]=e("label",{class:"text-sm text-medium-gray"},"Sort by:",-1)),m(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>S.value=s),class:"text-sm border border-light-border rounded px-2 py-1 focus:outline-none focus:border-charcoal"},[...t[27]||(t[27]=[w('<option value="rating-desc" data-v-21116703>Rating (High to Low)</option><option value="rating-asc" data-v-21116703>Rating (Low to High)</option><option value="date-desc" data-v-21116703>Date (Newest)</option><option value="date-asc" data-v-21116703>Date (Oldest)</option><option value="name" data-v-21116703>Name</option>',5)])],512),[[f,S.value]])])])]),b.value.length>0&&g.value==="card"?(o(),l("div",ft,[(o(!0),l(k,null,_(b.value,s=>(o(),I(E,{key:s.name,risk:s,onClick:j=>U(s)},null,8,["risk","onClick"]))),128))])):v("",!0),b.value.length>0&&g.value==="table"?(o(),l("div",ht,[e("div",bt,[e("table",yt,[t[29]||(t[29]=e("thead",{class:"bg-light-gray"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-semibold text-charcoal uppercase"},"Risk ID"),e("th",{class:"px-4 py-3 text-left text-xs font-semibold text-charcoal uppercase"},"Description"),e("th",{class:"px-4 py-3 text-left text-xs font-semibold text-charcoal uppercase"},"Department"),e("th",{class:"px-4 py-3 text-left text-xs font-semibold text-charcoal uppercase"},"Unit"),e("th",{class:"px-4 py-3 text-left text-xs font-semibold text-charcoal uppercase"},"Risk Level"),e("th",{class:"px-4 py-3 text-left text-xs font-semibold text-charcoal uppercase"},"Rating"),e("th",{class:"px-4 py-3 text-left text-xs font-semibold text-charcoal uppercase"},"Owner"),e("th",{class:"px-4 py-3 text-left text-xs font-semibold text-charcoal uppercase"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-semibold text-charcoal uppercase"},"Review Status"),e("th",{class:"px-4 py-3 text-right text-xs font-semibold text-charcoal uppercase"},"Actions")])],-1)),e("tbody",kt,[(o(!0),l(k,null,_(b.value,s=>(o(),l("tr",{key:s.name,class:"hover:bg-off-white transition-colors"},[e("td",_t,i(s.name),1),e("td",wt,[e("div",Ct,i(s.risk_description),1)]),e("td",St,i(s.department||"-"),1),e("td",Dt,i(s.unit||"-"),1),e("td",Rt,[e("span",{class:C(["px-2 py-1 rounded-full text-xs font-semibold whitespace-nowrap",{"bg-critical-light text-critical-dark":s.risk_level==="Critical","bg-high-light text-high-dark":s.risk_level==="High","bg-medium-light text-medium-dark":s.risk_level==="Medium","bg-low-light text-low-dark":s.risk_level==="Low"}])},i(s.risk_level),3)]),e("td",Mt,i(s.overall_rating||"-"),1),e("td",Lt,i(s.risk_owner||"-"),1),e("td",Ut,[e("span",{class:C(["px-2 py-1 rounded-full text-xs font-semibold whitespace-nowrap",{"bg-green-100 text-green-700":s.status==="Open","bg-blue-100 text-blue-700":s.status==="In Progress","bg-gray-100 text-gray-600":s.status==="Closed","bg-purple-100 text-purple-700":s.status==="Mitigated"}])},i(s.status),3)]),e("td",Vt,[s.review_status==="Overdue"?(o(),l("span",Nt,"ðŸ”´ Overdue")):s.review_status==="Due Soon"?(o(),l("span",Ot,"ðŸŸ¡ Due Soon")):s.review_status==="On Track"?(o(),l("span",At,"ðŸŸ¢ On Track")):(o(),l("span",zt,"âšª Not Scheduled"))]),e("td",Bt,[e("button",{onClick:j=>U(s),class:"text-sm text-red-primary hover:text-red-dark font-medium"}," View ",8,Ht)])]))),128))])])])])):(o(),l("div",jt,[t[30]||(t[30]=e("svg",{class:"w-16 h-16 text-medium-gray mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),t[31]||(t[31]=e("p",{class:"text-medium-gray mb-2"},"No risks found matching your criteria",-1)),e("button",{onClick:L,class:"text-red-primary hover:text-red-hover font-medium"}," Clear filters ")]))]))]))}},Gt=q(Tt,[["__scopeId","data-v-21116703"]]);export{Gt as default};
