import{D as M,o as n,e as o,f as a,h as y,w as h,m as _,n as g,x as C,y as U,G as N,t as b,j as $,F as V,C as A,k as T,r as u}from"./vue-vendor-DORe5Ms0.js";import{u as L}from"./useApi-C5Er8QzO.js";import"./index-Dy9jsXtf.js";const R={class:"animate-fade-in"},z={class:"mb-6 border-b border-light-border"},E={class:"flex space-x-6"},G={class:"card mb-6"},S={class:"flex gap-3"},q=["disabled"],H={key:0,class:"text-sm text-red-600 mt-2"},I={key:0,class:"flex items-center justify-center py-20"},J={key:1,class:"space-y-4"},O={class:"flex items-center justify-between mb-4"},P={class:"text-lg font-bold text-charcoal"},Q=["onClick"],W={key:0,class:"space-y-2 mb-3"},X={class:"text-charcoal"},Y=["onClick"],Z={key:1,class:"text-sm text-medium-gray mb-3"},ee={class:"flex gap-2 border-t border-light-border pt-3"},te=["onUpdate:modelValue","onKeyup"],ae=["onClick","disabled"],se={key:0,class:"card text-center py-12"},de={__name:"Departments",setup(re){const c=L(),f=u([]),d=u(""),p=u({}),r=u(!1),x=u(!1),l=u(""),v=async()=>{x.value=!0,f.value=await c.getDepartments(),x.value=!1},k=async()=>{if(!d.value.trim())return;r.value=!0,l.value="";const t=await c.createDepartment(d.value);r.value=!1,t.success?(d.value="",await v()):l.value=t.message||"Failed to create department"},D=async t=>{const e=p.value[t.name];if(!(e!=null&&e.trim()))return;r.value=!0,l.value="";const m=await c.createUnit(e,t.name);r.value=!1,m.success?(p.value[t.name]="",await v()):l.value=m.message||"Failed to create unit"},F=t=>{confirm(`Delete department "${t.department_name}"? This will fail if risks or units are linked.`)&&j(t)},j=async t=>{r.value=!0,l.value="";const e=await c.deleteDepartment(t.name);r.value=!1,e.success?await v():l.value=e.message||"Failed to delete department"},K=t=>{confirm(`Delete unit "${t.unit_name}"?`)&&B(t)},B=async t=>{r.value=!0,l.value="";const e=await c.deleteUnit(t.name);r.value=!1,e.success?await v():l.value=e.message||"Failed to delete unit"};return M(()=>{v()}),(t,e)=>{const m=T("router-link");return n(),o("div",R,[e[7]||(e[7]=a("div",{class:"mb-6"},[a("h1",{class:"text-3xl font-bold text-charcoal mb-2"},"Administration"),a("p",{class:"text-medium-gray"},"Manage departments, users, and roles")],-1)),a("div",z,[a("nav",E,[y(m,{to:"/admin/departments",class:g(["pb-3 px-1 border-b-2 font-medium text-sm transition-colors",t.$route.path==="/admin/departments"?"border-red-primary text-red-primary":"border-transparent text-medium-gray hover:text-charcoal hover:border-light-border"])},{default:h(()=>[...e[1]||(e[1]=[_(" Departments & Units ",-1)])]),_:1},8,["class"]),y(m,{to:"/admin/users",class:g(["pb-3 px-1 border-b-2 font-medium text-sm transition-colors",t.$route.path==="/admin/users"?"border-red-primary text-red-primary":"border-transparent text-medium-gray hover:text-charcoal hover:border-light-border"])},{default:h(()=>[...e[2]||(e[2]=[_(" Users ",-1)])]),_:1},8,["class"]),y(m,{to:"/admin/roles",class:g(["pb-3 px-1 border-b-2 font-medium text-sm transition-colors",t.$route.path==="/admin/roles"?"border-red-primary text-red-primary":"border-transparent text-medium-gray hover:text-charcoal hover:border-light-border"])},{default:h(()=>[...e[3]||(e[3]=[_(" Roles Reference ",-1)])]),_:1},8,["class"])])]),a("div",G,[e[4]||(e[4]=a("h2",{class:"card-header"},"Add New Department",-1)),a("div",S,[C(a("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>d.value=s),type:"text",placeholder:"Department Name",class:"input flex-1",onKeyup:N(k,["enter"])},null,544),[[U,d.value]]),a("button",{onClick:k,disabled:!d.value.trim()||r.value,class:"btn btn-primary"},b(r.value?"Creating...":"Add Department"),9,q)]),l.value?(n(),o("div",H,b(l.value),1)):$("",!0)]),x.value?(n(),o("div",I,[...e[5]||(e[5]=[a("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-primary"},null,-1)])])):(n(),o("div",J,[(n(!0),o(V,null,A(f.value,s=>{var w;return n(),o("div",{key:s.name,class:"card"},[a("div",O,[a("h3",P,b(s.department_name),1),a("button",{onClick:i=>F(s),class:"text-sm text-red-primary hover:text-red-dark font-medium",title:"Delete Department"}," Delete ",8,Q)]),s.units&&s.units.length>0?(n(),o("div",W,[(n(!0),o(V,null,A(s.units,i=>(n(),o("div",{key:i.name,class:"flex items-center justify-between bg-light-gray rounded p-3"},[a("span",X,b(i.unit_name),1),a("button",{onClick:ne=>K(i),class:"text-xs text-red-primary hover:text-red-dark font-medium"}," Delete ",8,Y)]))),128))])):(n(),o("div",Z,"No units yet")),a("div",ee,[C(a("input",{"onUpdate:modelValue":i=>p.value[s.name]=i,type:"text",placeholder:"New Unit Name",class:"input flex-1 text-sm",onKeyup:N(i=>D(s),["enter"])},null,40,te),[[U,p.value[s.name]]]),a("button",{onClick:i=>D(s),disabled:!((w=p.value[s.name])!=null&&w.trim())||r.value,class:"btn btn-outline text-sm"}," Add Unit ",8,ae)])])}),128)),f.value.length===0?(n(),o("div",se,[...e[6]||(e[6]=[a("p",{class:"text-medium-gray"},"No departments yet. Add one above to get started.",-1)])])):$("",!0)]))])}}};export{de as default};
