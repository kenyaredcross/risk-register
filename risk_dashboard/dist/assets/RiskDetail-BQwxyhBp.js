import{r as k,o as a,e as d,f as e,t as l,v as q,x as j,y as A,j as c,c as T,D as H,u as i,n as C,F as N,C as S,g as Q,i as W,m as D,l as G,A as J}from"./vue-vendor-DORe5Ms0.js";import{u as K}from"./riskStore-xlymeSig.js";import{u as X}from"./useApi-Dztx0DcP.js";import"./index-CtnbHJYv.js";const Y={class:"bg-white rounded-lg shadow-elegant-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto animate-scale-in"},Z={class:"sticky top-0 bg-white border-b border-light-border px-6 py-4 flex items-center justify-between"},ee={class:"text-xl font-bold text-charcoal"},te={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},se={key:0,class:"p-4 bg-red-light rounded-lg"},ie={class:"text-sm text-red-dark"},le={class:"flex items-center justify-end space-x-3 pt-4 border-t border-light-border"},oe=["disabled"],ae={key:0},de={key:1},re={__name:"ReviewForm",props:{review:{type:Object,default:null},reviewIndex:{type:Number,default:null}},emits:["close","submit"],setup(F,{emit:M}){var u,v,h,y,w;const g=F,s=M,b=T(()=>g.review!==null),m=k({review_date:((u=g.review)==null?void 0:u.review_date)||"",reviewed_by:((v=g.review)==null?void 0:v.reviewed_by)||"",summary:((h=g.review)==null?void 0:h.summary)||"",actions:((y=g.review)==null?void 0:y.actions)||"",next_review_date:((w=g.review)==null?void 0:w.next_review_date)||""}),f=k(!1),R=k(""),$=async()=>{f.value=!0,R.value="";try{s("submit",{data:m.value,index:g.reviewIndex})}catch(_){R.value=_.message||"Failed to save review"}finally{f.value=!1}};return(_,r)=>(a(),d("div",{class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:r[7]||(r[7]=q(x=>_.$emit("close"),["self"]))},[e("div",Y,[e("div",Z,[e("h2",ee,l(b.value?"Edit Review":"Add New Review"),1),e("button",{onClick:r[0]||(r[0]=x=>_.$emit("close")),class:"text-medium-gray hover:text-charcoal"},[...r[8]||(r[8]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:q($,["prevent"]),class:"p-6 space-y-6"},[e("div",te,[e("div",null,[r[9]||(r[9]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Review Date *",-1)),j(e("input",{"onUpdate:modelValue":r[1]||(r[1]=x=>m.value.review_date=x),type:"date",required:"",class:"input"},null,512),[[A,m.value.review_date]])]),e("div",null,[r[10]||(r[10]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Reviewed By *",-1)),j(e("input",{"onUpdate:modelValue":r[2]||(r[2]=x=>m.value.reviewed_by=x),type:"text",required:"",placeholder:"Enter reviewer name",class:"input"},null,512),[[A,m.value.reviewed_by]])])]),e("div",null,[r[11]||(r[11]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Summary of Review *",-1)),j(e("textarea",{"onUpdate:modelValue":r[3]||(r[3]=x=>m.value.summary=x),required:"",rows:"4",placeholder:"Describe what was reviewed and key findings...",class:"input resize-none"},null,512),[[A,m.value.summary]])]),e("div",null,[r[12]||(r[12]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Decisions / Actions Agreed *",-1)),j(e("textarea",{"onUpdate:modelValue":r[4]||(r[4]=x=>m.value.actions=x),required:"",rows:"4",placeholder:"List actions and decisions made during this review...",class:"input resize-none"},null,512),[[A,m.value.actions]])]),e("div",null,[r[13]||(r[13]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},"Next Review Date",-1)),j(e("input",{"onUpdate:modelValue":r[5]||(r[5]=x=>m.value.next_review_date=x),type:"date",class:"input"},null,512),[[A,m.value.next_review_date]])]),R.value?(a(),d("div",se,[e("p",ie,l(R.value),1)])):c("",!0),e("div",le,[e("button",{type:"button",onClick:r[6]||(r[6]=x=>_.$emit("close")),class:"btn btn-outline"}," Cancel "),e("button",{type:"submit",disabled:f.value,class:"btn btn-primary"},[f.value?(a(),d("span",ae,"Saving...")):(a(),d("span",de,l(b.value?"Update Review":"Add Review"),1))],8,oe)])],32)])]))}},ne={class:"animate-fade-in"},ue={key:0,class:"flex items-center justify-center py-20"},ce={key:1},me={class:"mb-6"},ve={class:"flex items-start justify-between"},xe={class:"text-3xl font-bold text-charcoal mb-1"},pe={class:"text-sm text-medium-gray font-mono mb-1"},ge={class:"text-medium-gray"},ke={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},be={class:"lg:col-span-2 space-y-6"},ye={class:"card"},we={class:"text-charcoal"},fe={class:"card"},Re={class:"grid grid-cols-3 gap-6"},he={class:"text-center p-4 bg-light-gray rounded-lg"},_e={class:"text-4xl font-bold text-charcoal"},Ce={class:"text-center p-4 bg-light-gray rounded-lg"},je={class:"text-4xl font-bold text-charcoal"},Ae={key:0,class:"card"},$e={class:"space-y-2"},Ne={class:"text-charcoal"},Se={key:1,class:"card"},Me={class:"space-y-2"},Be={class:"text-charcoal"},De={key:2,class:"card"},qe={class:"space-y-3"},Fe={class:"font-semibold text-charcoal mb-2"},Ve={class:"grid grid-cols-2 gap-4 text-sm"},ze={class:"ml-2 text-charcoal"},Le={class:"ml-2 text-charcoal"},Ue={class:"card"},Ie={class:"flex items-center justify-between mb-6"},Pe={key:0,class:"relative"},Ee={class:"space-y-8"},Oe={class:"bg-light-gray rounded-lg p-4 hover:shadow-md transition-shadow"},Te={class:"flex items-start justify-between mb-3"},He={class:"font-bold text-charcoal text-lg"},Qe={class:"text-sm text-medium-gray flex items-center mt-1"},We=["onClick"],Ge={key:0,class:"mb-3"},Je={class:"text-sm text-charcoal whitespace-pre-wrap leading-relaxed"},Ke={key:1,class:"mb-3"},Xe={class:"text-sm text-charcoal whitespace-pre-wrap leading-relaxed"},Ye={key:2,class:"flex items-center text-xs text-medium-gray mt-3 pt-3 border-t border-white"},Ze={key:1,class:"text-center py-12 text-medium-gray"},et={class:"space-y-6"},tt={class:"card"},st={class:"space-y-4"},it={class:"text-charcoal font-medium"},lt={class:"text-charcoal font-medium"},ot={class:"text-charcoal font-medium"},at={class:"text-charcoal font-medium"},dt={class:"text-charcoal font-medium"},rt={class:"badge badge-medium"},nt={class:"text-charcoal font-medium"},ut={class:"card"},ct={class:"space-y-4"},mt={class:"text-charcoal font-medium"},vt={class:"text-charcoal font-medium"},xt={class:"card"},pt={class:"space-y-3"},gt={class:"text-sm text-charcoal"},kt={class:"text-sm text-charcoal"},bt={class:"card"},yt={class:"space-y-4"},wt={key:0},ft={class:"text-xs text-medium-gray mb-1"},Rt={class:"text-charcoal font-medium text-sm"},ht={key:1},_t={class:"text-charcoal font-medium text-sm"},Ct={key:2},jt={class:"text-sm text-red-700 bg-red-50 rounded p-2"},At={class:"space-y-2 pt-2 border-t border-light-border"},$t=["disabled"],Nt=["disabled"],St=["disabled"],Mt=["disabled"],Bt={key:4,class:"text-xs text-red-600 mt-1"},Dt={class:"card"},qt={class:"space-y-2"},Ft=["href"],Vt={key:2,class:"card text-center py-12"},zt={class:"bg-white rounded-lg shadow-elegant-xl max-w-md w-full p-6"},Lt={key:0,class:"text-sm text-red-600 mb-3"},Ut={class:"flex space-x-3"},It=["disabled"],Qt={__name:"RiskDetail",setup(F){const M=G(),g=J(),s=K(),b=X(),m=k(!1),f=k(null),R=k(null),$=k(!1),u=k(!1),v=k(""),h=k(!1),y=k(""),w=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A",_=o=>({low:"badge-low",medium:"badge-medium",high:"badge-high",critical:"badge-critical"})[(o||"").toLowerCase()]||"badge-medium",r=o=>({Overdue:"bg-red-100 text-red-700","Due Soon":"bg-yellow-100 text-yellow-700","On Track":"bg-green-100 text-green-700","Not Scheduled":"bg-gray-100 text-gray-500"})[o]||"bg-gray-100 text-gray-500",x=o=>o>=15?"bg-red-light":o>=10?"bg-orange-100":o>=5?"bg-yellow-100":"bg-green-100",B=o=>o>=15?"text-red-dark":o>=10?"text-orange-800":o>=5?"text-yellow-800":"text-green-800",V=(o=null,t=null)=>{f.value=o,R.value=t,m.value=!0},z=()=>{m.value=!1,f.value=null,R.value=null},L=async({data:o,index:t})=>{const n=s.selectedRisk.name;let p;t!==null?p=await b.updateRiskReview(n,t,o):p=await b.addRiskReview(n,o),p.success?(await s.loadRisk(n),z()):alert(p.message||"Failed to save review")},U=o=>({Draft:"bg-gray-100 text-gray-600","Pending Approval":"bg-orange-100 text-orange-700",Open:"bg-green-100 text-green-700","Pending Close Approval":"bg-orange-100 text-orange-700",Closed:"bg-blue-100 text-blue-700",Rejected:"bg-red-100 text-red-700"})[o]||"bg-gray-100 text-gray-600",I=async()=>{u.value=!0,v.value="";const o=await b.submitForApproval(s.selectedRisk.name);u.value=!1,o.success?await s.loadRisk(s.selectedRisk.name):v.value=o.message||"Failed to submit."},P=async()=>{u.value=!0,v.value="";const o=await b.requestClose(s.selectedRisk.name);u.value=!1,o.success?await s.loadRisk(s.selectedRisk.name):v.value=o.message||"Failed to request closure."},E=async()=>{u.value=!0,v.value="";const o=await b.approveRisk(s.selectedRisk.name);u.value=!1,o.success?await s.loadRisk(s.selectedRisk.name):v.value=o.message||"Failed to approve."},O=async()=>{if(!y.value.trim())return;u.value=!0,v.value="";const o=await b.rejectRisk(s.selectedRisk.name,y.value);u.value=!1,o.success?(h.value=!1,y.value="",await s.loadRisk(s.selectedRisk.name)):v.value=o.message||"Failed to reject."};return H(async()=>{const o=M.params.id;await s.loadRisk(o);const t=await b.canApproveRisk(o);$.value=t.can_approve}),(o,t)=>(a(),d("div",ne,[i(s).loading?(a(),d("div",ue,[...t[8]||(t[8]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-primary"},null,-1)])])):i(s).selectedRisk?(a(),d("div",ce,[e("div",me,[e("button",{onClick:t[0]||(t[0]=n=>i(g).back()),class:"text-medium-gray hover:text-charcoal mb-4 flex items-center space-x-2"},[...t[9]||(t[9]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),e("span",null,"Back",-1)])]),e("div",ve,[e("div",null,[e("h1",xe,l(i(s).selectedRisk.project||i(s).selectedRisk.name),1),e("p",pe,l(i(s).selectedRisk.name),1),e("p",ge,l(w(i(s).selectedRisk.creation)),1)]),e("span",{class:C(["badge text-base px-4 py-2",_(i(s).selectedRisk.risk_level)])},l(i(s).selectedRisk.risk_level||"Unknown"),3)])]),e("div",ke,[e("div",be,[e("div",ye,[t[10]||(t[10]=e("h2",{class:"card-header"},"Risk Description",-1)),e("p",we,l(i(s).selectedRisk.risk_description||"No description available"),1)]),e("div",fe,[t[15]||(t[15]=e("h2",{class:"card-header"},"Risk Assessment",-1)),e("div",Re,[e("div",he,[t[11]||(t[11]=e("div",{class:"text-sm text-medium-gray mb-2"},"Likelihood",-1)),e("div",_e,l(i(s).selectedRisk.likelihood||0),1),t[12]||(t[12]=e("div",{class:"text-xs text-medium-gray mt-1"},"out of 5",-1))]),e("div",Ce,[t[13]||(t[13]=e("div",{class:"text-sm text-medium-gray mb-2"},"Impact",-1)),e("div",je,l(i(s).selectedRisk.impact||0),1),t[14]||(t[14]=e("div",{class:"text-xs text-medium-gray mt-1"},"out of 5",-1))]),e("div",{class:C(["text-center p-4 rounded-lg",x(i(s).selectedRisk.overall_rating)])},[e("div",{class:C(["text-sm mb-2",B(i(s).selectedRisk.overall_rating)])},"Overall Rating",2),e("div",{class:C(["text-4xl font-bold",B(i(s).selectedRisk.overall_rating)])},l(i(s).selectedRisk.overall_rating||0),3),e("div",{class:C(["text-xs mt-1",B(i(s).selectedRisk.overall_rating)])},"Likelihood Ã— Impact",2)],2)])]),i(s).selectedRisk.possible_causes&&i(s).selectedRisk.possible_causes.length>0?(a(),d("div",Ae,[t[17]||(t[17]=e("h2",{class:"card-header"},"Possible Causes",-1)),e("ul",$e,[(a(!0),d(N,null,S(i(s).selectedRisk.possible_causes,(n,p)=>(a(),d("li",{key:p,class:"flex items-start space-x-2"},[t[16]||(t[16]=e("svg",{class:"w-5 h-5 text-red-primary mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)),e("span",Ne,l(n.cause),1)]))),128))])])):c("",!0),i(s).selectedRisk.risk_consequences&&i(s).selectedRisk.risk_consequences.length>0?(a(),d("div",Se,[t[19]||(t[19]=e("h2",{class:"card-header"},"Risk Consequences",-1)),e("ul",Me,[(a(!0),d(N,null,S(i(s).selectedRisk.risk_consequences,(n,p)=>(a(),d("li",{key:p,class:"flex items-start space-x-2"},[t[18]||(t[18]=e("svg",{class:"w-5 h-5 text-red-primary mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),e("span",Be,l(n.effect),1)]))),128))])])):c("",!0),i(s).selectedRisk.mitigating_actions&&i(s).selectedRisk.mitigating_actions.length>0?(a(),d("div",De,[t[22]||(t[22]=e("h2",{class:"card-header"},"Mitigating Actions",-1)),e("div",qe,[(a(!0),d(N,null,S(i(s).selectedRisk.mitigating_actions,(n,p)=>(a(),d("div",{key:p,class:"p-4 bg-light-gray rounded-lg"},[e("div",Fe,l(n.action),1),e("div",Ve,[e("div",null,[t[20]||(t[20]=e("span",{class:"text-medium-gray"},"Responsibility:",-1)),e("span",ze,l(n.responsibility||"N/A"),1)]),e("div",null,[t[21]||(t[21]=e("span",{class:"text-medium-gray"},"Timeline:",-1)),e("span",Le,l(n.timeline||"N/A"),1)])])]))),128))])])):c("",!0),e("div",Ue,[e("div",Ie,[t[23]||(t[23]=e("h2",{class:"card-header mb-0"},"Risk Reviews",-1)),e("button",{onClick:t[1]||(t[1]=n=>V()),class:"btn btn-danger text-sm"}," Add Review ")]),i(s).selectedRisk.risk_reviews&&i(s).selectedRisk.risk_reviews.length>0?(a(),d("div",Pe,[t[30]||(t[30]=e("div",{class:"absolute left-4 top-0 bottom-0 w-0.5 bg-light-gray"},null,-1)),e("div",Ee,[(a(!0),d(N,null,S(i(s).selectedRisk.risk_reviews,(n,p)=>(a(),d("div",{key:p,class:"relative pl-12"},[t[29]||(t[29]=e("div",{class:"absolute left-2.5 top-1 w-3 h-3 rounded-full bg-red-primary ring-4 ring-white"},null,-1)),e("div",Oe,[e("div",Te,[e("div",null,[e("div",He,l(w(n.review_date)),1),e("div",Qe,[t[24]||(t[24]=e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),D(" "+l(n.reviewed_by),1)])]),e("button",{onClick:Pt=>V(n,p),class:"text-medium-gray hover:text-red-primary transition-colors",title:"Edit"},[...t[25]||(t[25]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,We)]),n.summary?(a(),d("div",Ge,[t[26]||(t[26]=e("div",{class:"text-xs font-bold text-medium-gray uppercase tracking-wide mb-1"},"Summary",-1)),e("div",Je,l(n.summary),1)])):c("",!0),n.actions?(a(),d("div",Ke,[t[27]||(t[27]=e("div",{class:"text-xs font-bold text-medium-gray uppercase tracking-wide mb-1"},"Actions Agreed",-1)),e("div",Xe,l(n.actions),1)])):c("",!0),n.next_review_date?(a(),d("div",Ye,[t[28]||(t[28]=e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),D(" Next Review: "+l(w(n.next_review_date)),1)])):c("",!0)])]))),128))])])):(a(),d("div",Ze,[...t[31]||(t[31]=[Q('<div class="w-16 h-16 mx-auto mb-4 rounded-full bg-light-gray flex items-center justify-center"><svg class="w-8 h-8 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div><p class="font-medium">No reviews yet</p><p class="text-sm mt-1">Click &quot;Add Review&quot; to create the first review</p>',3)])]))])]),e("div",et,[e("div",tt,[t[39]||(t[39]=e("h2",{class:"card-header"},"Quick Info",-1)),e("div",st,[e("div",null,[t[32]||(t[32]=e("div",{class:"text-xs text-medium-gray mb-1"},"Risk Category",-1)),e("div",it,l(i(s).selectedRisk.risk_category||"N/A"),1)]),e("div",null,[t[33]||(t[33]=e("div",{class:"text-xs text-medium-gray mb-1"},"Risk Owner",-1)),e("div",lt,l(i(s).selectedRisk.risk_owner||"Unassigned"),1)]),e("div",null,[t[34]||(t[34]=e("div",{class:"text-xs text-medium-gray mb-1"},"Department",-1)),e("div",ot,l(i(s).selectedRisk.department||"N/A"),1)]),e("div",null,[t[35]||(t[35]=e("div",{class:"text-xs text-medium-gray mb-1"},"Unit",-1)),e("div",at,l(i(s).selectedRisk.unit||"N/A"),1)]),e("div",null,[t[36]||(t[36]=e("div",{class:"text-xs text-medium-gray mb-1"},"Region",-1)),e("div",dt,l(i(s).selectedRisk.region||"N/A"),1)]),e("div",null,[t[37]||(t[37]=e("div",{class:"text-xs text-medium-gray mb-1"},"Status",-1)),e("span",rt,l(i(s).selectedRisk.status||"Unknown"),1)]),e("div",null,[t[38]||(t[38]=e("div",{class:"text-xs text-medium-gray mb-1"},"Timeline",-1)),e("div",nt,l(i(s).selectedRisk.timeline||"N/A"),1)])])]),e("div",ut,[t[43]||(t[43]=e("h2",{class:"card-header"},"Review Schedule",-1)),e("div",ct,[e("div",null,[t[40]||(t[40]=e("div",{class:"text-xs text-medium-gray mb-1"},"Frequency",-1)),e("div",mt,l(i(s).selectedRisk.review_frequency||"Not Set"),1)]),e("div",null,[t[41]||(t[41]=e("div",{class:"text-xs text-medium-gray mb-1"},"Next Review Due",-1)),e("div",vt,l(i(s).selectedRisk.next_review_due||"N/A"),1)]),e("div",null,[t[42]||(t[42]=e("div",{class:"text-xs text-medium-gray mb-1"},"Review Status",-1)),e("span",{class:C(["px-2 py-1 rounded-full text-xs font-semibold",r(i(s).selectedRisk.review_status)])},l(i(s).selectedRisk.review_status||"Not Scheduled"),3)])])]),e("div",xt,[t[46]||(t[46]=e("h2",{class:"card-header"},"Timeline",-1)),e("div",pt,[e("div",null,[t[44]||(t[44]=e("div",{class:"text-xs text-medium-gray mb-1"},"Created",-1)),e("div",gt,l(w(i(s).selectedRisk.creation)),1)]),e("div",null,[t[45]||(t[45]=e("div",{class:"text-xs text-medium-gray mb-1"},"Last Modified",-1)),e("div",kt,l(w(i(s).selectedRisk.modified)),1)])])]),e("div",bt,[t[50]||(t[50]=e("h2",{class:"card-header"},"Approval",-1)),e("div",yt,[e("div",null,[t[47]||(t[47]=e("div",{class:"text-xs text-medium-gray mb-1"},"Workflow Status",-1)),e("span",{class:C(["px-3 py-1 rounded-full text-xs font-semibold",U(i(s).selectedRisk.status)])},l(i(s).selectedRisk.status||"Draft"),3)]),i(s).selectedRisk.approved_by?(a(),d("div",wt,[e("div",ft,l(i(s).selectedRisk.status==="Rejected"?"Rejected By":"Approved By"),1),e("div",Rt,l(i(s).selectedRisk.approved_by),1)])):c("",!0),i(s).selectedRisk.approval_date?(a(),d("div",ht,[t[48]||(t[48]=e("div",{class:"text-xs text-medium-gray mb-1"},"Date",-1)),e("div",_t,l(w(i(s).selectedRisk.approval_date)),1)])):c("",!0),i(s).selectedRisk.rejection_reason?(a(),d("div",Ct,[t[49]||(t[49]=e("div",{class:"text-xs text-medium-gray mb-1"},"Rejection Reason",-1)),e("div",jt,l(i(s).selectedRisk.rejection_reason),1)])):c("",!0),e("div",At,[i(s).selectedRisk.status==="Draft"||i(s).selectedRisk.status==="Rejected"?(a(),d("button",{key:0,onClick:I,disabled:u.value,class:"btn btn-primary w-full text-sm"},l(u.value?"Submitting...":"Submit for Approval"),9,$t)):c("",!0),i(s).selectedRisk.status==="Open"?(a(),d("button",{key:1,onClick:P,disabled:u.value,class:"btn btn-outline w-full text-sm"},l(u.value?"Requesting...":"Request Closure"),9,Nt)):c("",!0),$.value&&(i(s).selectedRisk.status==="Pending Approval"||i(s).selectedRisk.status==="Pending Close Approval")?(a(),d("button",{key:2,onClick:E,disabled:u.value,class:"btn btn-primary w-full text-sm"},l(u.value?"Approving...":"Approve"),9,St)):c("",!0),$.value&&(i(s).selectedRisk.status==="Pending Approval"||i(s).selectedRisk.status==="Pending Close Approval")?(a(),d("button",{key:3,onClick:t[2]||(t[2]=n=>h.value=!0),disabled:u.value,class:"w-full px-4 py-2 border border-red-primary text-red-primary rounded-lg hover:bg-red-50 transition-colors text-sm font-medium"}," Reject ",8,Mt)):c("",!0),v.value?(a(),d("div",Bt,l(v.value),1)):c("",!0)])])]),e("div",Dt,[t[51]||(t[51]=e("h2",{class:"card-header"},"Actions",-1)),e("div",qt,[e("a",{href:`/app/program-risk-register/${i(s).selectedRisk.name}`,target:"_blank",class:"btn btn-primary w-full block text-center"}," Edit in Frappe ",8,Ft),e("button",{onClick:t[3]||(t[3]=n=>i(g).push("/risks")),class:"btn btn-outline w-full"}," View All Risks ")])])])])])):(a(),d("div",Vt,[t[52]||(t[52]=e("svg",{class:"w-16 h-16 text-medium-gray mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t[53]||(t[53]=e("p",{class:"text-medium-gray mb-4"},"Risk not found",-1)),e("button",{onClick:t[4]||(t[4]=n=>i(g).push("/risks")),class:"btn btn-outline"}," Back to Risk Register ")])),m.value?(a(),W(re,{key:3,review:f.value,"review-index":R.value,onClose:z,onSubmit:L},null,8,["review","review-index"])):c("",!0),h.value?(a(),d("div",{key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:t[7]||(t[7]=q(n=>h.value=!1,["self"]))},[e("div",zt,[t[54]||(t[54]=e("h3",{class:"text-lg font-bold text-charcoal mb-4"},"Reject Risk",-1)),t[55]||(t[55]=e("label",{class:"block text-sm font-medium text-charcoal mb-2"},[D("Rejection Reason "),e("span",{class:"text-red-primary"},"*")],-1)),j(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=n=>y.value=n),rows:"3",placeholder:"Provide a reason for rejection...",class:"input w-full mb-4"},null,512),[[A,y.value]]),v.value?(a(),d("div",Lt,l(v.value),1)):c("",!0),e("div",Ut,[e("button",{onClick:t[6]||(t[6]=n=>h.value=!1),class:"btn btn-outline flex-1"},"Cancel"),e("button",{onClick:O,disabled:!y.value.trim()||u.value,class:"flex-1 px-4 py-2 bg-red-primary text-white rounded-lg hover:bg-red-dark disabled:opacity-50 font-medium"},l(u.value?"Rejecting...":"Confirm Reject"),9,It)])])])):c("",!0)]))}};export{Qt as default};
